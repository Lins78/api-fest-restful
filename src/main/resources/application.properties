# ===============================================================================
# ROTEIRO 3 - CONFIGURAÇÕES DA API FEST RESTful - DeliveryTech System
# ===============================================================================
# 
# Este arquivo contém todas as configurações necessárias para o Roteiro 3:
# - Configurações básicas da aplicação Spring Boot
# - Banco de dados H2 em memória para desenvolvimento
# - Console H2 para visualização e debug
# - JPA/Hibernate com logs SQL detalhados
# - Otimizações para Java 21 LTS
# - Configurações de encoding e performance
# 
# @author DeliveryTech Development Team
# @version 1.0 - Roteiro 3
# @since Java 21 LTS + Spring Boot 3.4.0
# ===============================================================================

# ========== CONFIGURAÇÕES BÁSICAS DA APLICAÇÃO ==========
# Nome da aplicação conforme especificado no roteiro
spring.application.name=api-fest-restfull

# Porta do servidor web embarcado (Tomcat)
server.port=8080

# ========== CONFIGURAÇÕES DO BANCO H2 EM MEMÓRIA (ROTEIRO 3) ==========
# URL do banco H2 em memória com identificador 'delivery'
# Banco será recriado a cada execução da aplicação
spring.datasource.url=jdbc:h2:mem:delivery

# Driver JDBC específico do H2 Database Engine
spring.datasource.driver-class-name=org.h2.Driver

# Credenciais padrão do H2 (usuário 'sa' sem senha)
spring.datasource.username=sa
# H2 Database não requer senha (senha vazia)
spring.datasource.password=${DATABASE_PASSWORD:}

# ========== CONFIGURAÇÕES DO CONSOLE H2 ==========
# Habilita o console web do H2 para visualização dos dados em tempo real
# Essencial para debugging e validação das consultas do roteiro
spring.h2.console.enabled=true

# Define o endpoint do console H2 
# Acesso: http://localhost:8080/h2-console
spring.h2.console.path=/h2-console

# ========== CONFIGURAÇÕES JPA/HIBERNATE ==========
# Dialeto otimizado para H2 Database
spring.jpa.database-platform=org.hibernate.dialect.H2Dialect

# ========== CONFIGURAÇÕES SWAGGER/OPENAPI ==========
# Caminho para documentação JSON da API
springdoc.api-docs.path=/v3/api-docs

# Caminho customizado para Swagger UI
springdoc.swagger-ui.path=/swagger-ui.html

# Ordenação dos endpoints por método HTTP
springdoc.swagger-ui.operationsSorter=method

# Ordenação das tags alfabeticamente  
springdoc.swagger-ui.tagsSorter=alpha

# Desabilita validação de petname
springdoc.swagger-ui.disable-swagger-default-url=true

# Habilita try-it-out por padrão
springdoc.swagger-ui.tryItOutEnabled=true

# ========== CONFIGURAÇÕES SPRING BOOT ACTUATOR ==========
# Expor todos os endpoints do Actuator para monitoring
management.endpoints.web.exposure.include=health,info,metrics,env,beans,configprops,httptrace,loggers,threaddump,heapdump

# Configurar base path dos endpoints do Actuator
management.endpoints.web.base-path=/actuator

# Mostrar detalhes completos do health check
management.endpoint.health.show-details=always

# Configurar informações da aplicação
management.info.env.enabled=true
info.app.name=API FEST RESTful
info.app.description=Sistema de delivery de restaurantes
info.app.version=1.0.0
info.app.java.version=21
info.app.spring-boot.version=3.4.0

# Estratégia DDL: create para criar tabelas na primeira execução
# Ideal para desenvolvimento e testes dos cenários do roteiro
spring.jpa.hibernate.ddl-auto=create

# Configuração de inicialização do banco de dados
spring.sql.init.mode=always
spring.sql.init.schema-locations=classpath:schema.sql
spring.sql.init.data-locations=classpath:data.sql

# Exibe todas as queries SQL geradas pelo Hibernate
# Fundamental para aprendizado e debugging das consultas
spring.jpa.show-sql=true

# Formata as queries SQL para melhor legibilidade no console
spring.jpa.properties.hibernate.format_sql=true

# ========== CONFIGURAÇÕES DE LOGS E DEBUG AVANÇADO ==========
# Log detalhado das queries SQL executadas
logging.level.org.hibernate.SQL=DEBUG

# Log dos parâmetros (bind values) das queries preparadas
# Mostra os valores reais passados para as queries
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE

# Log das operações JDBC do Spring Data
logging.level.org.springframework.jdbc.core=DEBUG

# ========== CONFIGURAÇÕES DE PERFORMANCE JAVA 21 ==========
# Configuração otimizada de threads para Java 21 LTS
# Melhora a performance da aplicação com múltiplas requisições
server.tomcat.max-threads=200
server.tomcat.min-spare-threads=10

# ========== CONFIGURAÇÕES DE ENCODING ==========
# Força encoding UTF-8 em toda a aplicação
# Garante suporte correto a caracteres especiais e acentos
server.servlet.encoding.charset=UTF-8
server.servlet.encoding.force=true

# ========== CONFIGURAÇÕES DE OTIMIZAÇÃO JPA ==========
# Desabilita Open Session In View para melhor performance
# Evita lazy loading fora do contexto transacional
spring.jpa.open-in-view=false

# ===============================================================================
# INSTRUÇÕES DE USO DO ROTEIRO 3:
# 
# 1. ACESSANDO O CONSOLE H2:
#    - URL: http://localhost:8080/h2-console
#    - JDBC URL: jdbc:h2:mem:delivery  
#    - Username: sa
#    - Password: (deixar vazio)
# 
# 2. VISUALIZANDO DADOS DE TESTE:
#    - Os dados são automaticamente carregados pelo DataLoader
#    - 3 clientes, 2 restaurantes, 5 produtos e 2 pedidos
# 
# 3. VALIDANDO CONSULTAS:
#    - Todas as queries aparecem formatadas no console
#    - Os 4 cenários obrigatórios são executados automaticamente
#    - Logs detalhados mostram parâmetros e resultados
# 
# 4. DEBUGGING:
#    - Consulte os logs SQL para entender as queries geradas
#    - Use o console H2 para validar dados e estruturas
#    - DataLoader executa testes automáticos na inicialização
# ===============================================================================

# ========== CONFIGURAÇÕES DE SEGURANÇA - ROTEIRO 5 ==========
# Configurações de Spring Security para desenvolvimento

# Logging de Security para debugging (opcional - pode ser removido em produção)
logging.level.org.springframework.security=INFO

# Configurações de Session (preparação para JWT)
# Em desenvolvimento, usamos sessions. Em produção, será JWT stateless
server.servlet.session.cookie.secure=false
server.servlet.session.cookie.http-only=true
server.servlet.session.timeout=30m

# ========== CONFIGURAÇÕES DE CORS ADICIONAIS ==========
# Headers permitidos globalmente (complementa SecurityConfig)
spring.web.cors.allowed-origins=http://localhost:3000,http://localhost:4200,http://localhost:5173
spring.web.cors.allowed-methods=GET,POST,PUT,DELETE,PATCH,OPTIONS
spring.web.cors.allowed-headers=*
spring.web.cors.allow-credentials=true

# ========== CONFIGURAÇÕES JWT/AUTH ==========
# Configurações de JWT para autenticação
jwt.secret=${JWT_SECRET:delivery-tech-secret-key-2025-api-fest-restful-security}
# 24 horas em milissegundos
jwt.expiration=${JWT_EXPIRATION:86400000}